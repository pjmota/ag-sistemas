{"numFailedTestSuites":1,"numFailedTests":2,"numPassedTestSuites":0,"numPassedTests":14,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":1,"numTotalTests":16,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1762821570717,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["SchemaInitService - branches"],"duration":53,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches adiciona usuarios.nome/empresa e executa backfill quando tabelas existem","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1762821573769,"status":"passed","title":"adiciona usuarios.nome/empresa e executa backfill quando tabelas existem"},{"ancestorTitles":["SchemaInitService - branches"],"duration":19,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches pula backfill quando membros ausentes e ignora mensalidades ausente","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1762821573824,"status":"passed","title":"pula backfill quando membros ausentes e ignora mensalidades ausente"},{"ancestorTitles":["SchemaInitService - branches"],"duration":15,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches migra indicacoes adicionando usuario_* e removendo membro_* quando presentes","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1762821573844,"status":"passed","title":"migra indicacoes adicionando usuario_* e removendo membro_* quando presentes"},{"ancestorTitles":["SchemaInitService - branches"],"duration":12,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches migra obrigados adicionando usuario_id e removendo membro_id","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1762821573860,"status":"passed","title":"migra obrigados adicionando usuario_id e removendo membro_id"},{"ancestorTitles":["SchemaInitService - branches"],"duration":14,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches mensalidades existente sem membro_id adiciona apenas usuario_id","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1762821573872,"status":"passed","title":"mensalidades existente sem membro_id adiciona apenas usuario_id"},{"ancestorTitles":["SchemaInitService - branches"],"duration":9,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches mensalidades lança erro não esperado e registra warn","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1762821573886,"status":"passed","title":"mensalidades lança erro não esperado e registra warn"},{"ancestorTitles":["SchemaInitService - branches"],"duration":12,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches indicacoes: segundo describe ausente ignora remoções pós-sync","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1762821573896,"status":"passed","title":"indicacoes: segundo describe ausente ignora remoções pós-sync"},{"ancestorTitles":["SchemaInitService - branches"],"duration":8,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches indicacoes lança erro não esperado e registra warn","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1762821573909,"status":"passed","title":"indicacoes lança erro não esperado e registra warn"},{"ancestorTitles":["SchemaInitService - branches"],"duration":2,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches obrigados ausente loga mensagem e não adiciona colunas","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1762821573918,"status":"passed","title":"obrigados ausente loga mensagem e não adiciona colunas"},{"ancestorTitles":["SchemaInitService - branches"],"duration":8,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches obrigados lança erro não esperado e registra warn","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1762821573920,"status":"passed","title":"obrigados lança erro não esperado e registra warn"},{"ancestorTitles":["SchemaInitService - branches"],"duration":10,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches usuario_planos existente sem membro_id adiciona usuario_id","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1762821573930,"status":"passed","title":"usuario_planos existente sem membro_id adiciona usuario_id"},{"ancestorTitles":["SchemaInitService - branches"],"duration":15,"failing":false,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"[SchemaInit] Falha ao migrar membro_planos -> usuario_planos:\"\u001b[39m, \u001b[32mAnything\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"[SchemaInit] Falha ao migrar membro_planos -> usuario_planos:\"\u001b[39m, \u001b[32mAnything\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.<anonymous> (C:\\Users\\Mota\\Documents\\AG Sistemas\\backend\\src\\__tests__\\schema-init.service.branches.spec.ts:210:18)"],"fullName":"SchemaInitService - branches falha ao renomear membro_planos registra warn","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1762821573940,"status":"failed","title":"falha ao renomear membro_planos registra warn"},{"ancestorTitles":["SchemaInitService - branches"],"duration":10,"failing":false,"failureDetails":[{"matcherResult":{"message":"\u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"[SchemaInit] Falha ao remover tabelas legadas:\"\u001b[39m, \u001b[32mAnything\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mStringContaining \"[SchemaInit] Falha ao remover tabelas legadas:\"\u001b[39m, \u001b[32mAnything\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.<anonymous> (C:\\Users\\Mota\\Documents\\AG Sistemas\\backend\\src\\__tests__\\schema-init.service.branches.spec.ts:226:18)"],"fullName":"SchemaInitService - branches remoção de tabelas legadas falha e registra warn","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1762821573963,"status":"failed","title":"remoção de tabelas legadas falha e registra warn"},{"ancestorTitles":["SchemaInitService - branches"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches erro geral não esperado registra console.error","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1762821573974,"status":"passed","title":"erro geral não esperado registra console.error"},{"ancestorTitles":["SchemaInitService - branches"],"duration":22,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches renomeia membro_planos para usuario_planos e migra colunas","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1762821573976,"status":"passed","title":"renomeia membro_planos para usuario_planos e migra colunas"},{"ancestorTitles":["SchemaInitService - branches"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SchemaInitService - branches retorna cedo quando tabela usuarios ausente na primeira verificação","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1762821573999,"status":"passed","title":"retorna cedo quando tabela usuarios ausente na primeira verificação"}],"endTime":1762821574027,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mSchemaInitService - branches › falha ao renomear membro_planos registra warn\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mStringContaining \"[SchemaInit] Falha ao migrar membro_planos -> usuario_planos:\"\u001b[39m, \u001b[32mAnything\u001b[39m\n\n    Number of calls: \u001b[31m0\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 208 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 209 |\u001b[39m     \u001b[36mawait\u001b[39m service\u001b[33m.\u001b[39monModuleInit()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 210 |\u001b[39m     expect(warn)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'[SchemaInit] Falha ao migrar membro_planos -> usuario_planos:'\u001b[39m)\u001b[33m,\u001b[39m expect\u001b[33m.\u001b[39manything())\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 211 |\u001b[39m     warn\u001b[33m.\u001b[39mmockRestore()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 212 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 213 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/__tests__/schema-init.service.branches.spec.ts\u001b[39m\u001b[0m\u001b[2m:210:18)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mSchemaInitService - branches › remoção de tabelas legadas falha e registra warn\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\n    Expected: \u001b[32mStringContaining \"[SchemaInit] Falha ao remover tabelas legadas:\"\u001b[39m, \u001b[32mAnything\u001b[39m\n\n    Number of calls: \u001b[31m0\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 224 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 225 |\u001b[39m     \u001b[36mawait\u001b[39m service\u001b[33m.\u001b[39monModuleInit()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 226 |\u001b[39m     expect(warn)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(expect\u001b[33m.\u001b[39mstringContaining(\u001b[32m'[SchemaInit] Falha ao remover tabelas legadas:'\u001b[39m)\u001b[33m,\u001b[39m expect\u001b[33m.\u001b[39manything())\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                  \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 227 |\u001b[39m     warn\u001b[33m.\u001b[39mmockRestore()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 228 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 229 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/__tests__/schema-init.service.branches.spec.ts\u001b[39m\u001b[0m\u001b[2m:226:18)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\Mota\\Documents\\AG Sistemas\\backend\\src\\__tests__\\schema-init.service.branches.spec.ts","startTime":1762821570830,"status":"failed","summary":""}],"wasInterrupted":false}
